import pandas as pd

df = pd.read_csv("thursday/messy_cars.csv")

df.columns = ["Car_ID", "Car_Brand", "Car_Type", "Year_Made", "Cost_In_Pounds", "Distance_Travelled_In_Miles", "Colour"]
df["Distance_Travelled_In_Miles_Filled"] = df["Distance_Travelled_In_Miles"].fillna(df["Distance_Travelled_In_Miles"].mean())
df["Cost_In_Pounds_Filled"] = df["Cost_In_Pounds"].fillna(df["Cost_In_Pounds"].mean())
print(df)
# Car_ID	Car_Brand	Car_Type	Year_Made	Cost_In_Pounds	Distance_Travelled_In_Miles	Colour	Distance_Travelled_In_Miles_Filled	Cost_In_Pounds_Filled
# 0	CAR001	Honda	Coupe	2022	NaN	197300.0	White	197300.000000	31240.95
# 1	CAR002	Chevrolet	Coupe	2009	42065.0	119752.0	Blue	119752.000000	42065.00
# 2	CAR003	BMW	SUV	2022	31557.0	53984.0	Red	53984.000000	31557.00
# 3	CAR004	Chevrolet	Hatchback	2001	38763.0	45774.0	Yellow	45774.000000	38763.00
# 4	CAR005	Chevrolet	Hatchback	2006	37606.0	7568.0	Green	7568.000000	37606.00
# 5	CAR006	Ford	Coupe	2023	16534.0	125151.0	Black	125151.000000	16534.00
# 6	CAR007	BMW	Hatchback	2002	34127.0	198664.0	White	198664.000000	34127.00
# 7	CAR008	BMW	Hatchback	2009	NaN	138767.0	Yellow	138767.000000	31240.95
# 8	CAR009	BMW	Sedan	1997	NaN	129375.0	Black	129375.000000	31240.95
# 9	CAR010	NaN	Coupe	2008	NaN	184262.0	NaN	184262.000000	31240.95
# 10	CAR011	Honda	Convertible	2011	29253.0	141330.0	Red	141330.000000	29253.00
# 11	CAR012	BMW	Coupe	1998	29276.0	44504.0	Black	44504.000000	29276.00
# 12	CAR013	Chevrolet	Convertible	2012	28247.0	169231.0	NaN	169231.000000	28247.00
# 13	CAR014	Ford	Sedan	2002	29300.0	NaN	Yellow	99637.545455	29300.00
# 14	CAR015	Honda	SUV	1998	13529.0	66858.0	Black	66858.000000	13529.00
# 15	CAR016	NaN	Hatchback	1996	22262.0	134312.0	NaN	134312.000000	22262.00
# 16	CAR017	Honda	Sedan	2000	14268.0	NaN	Green	99637.545455	14268.00
# 17	CAR018	NaN	Hatchback	2016	26271.0	43660.0	Blue	43660.000000	26271.00
# 18	CAR019	NaN	SUV	2004	17185.0	139633.0	Yellow	139633.000000	17185.00
# 19	CAR020	Honda	SUV	1998	26243.0	31854.0	Black	31854.000000	26243.00
# 20	CAR021	Ford	Sedan	2016	44099.0	69505.0	Red	69505.000000	44099.00
# 21	CAR022	Chevrolet	SUV	2023	NaN	109488.0	Blue	109488.000000	31240.95
# 22	CAR023	Honda	Convertible	2012	44976.0	NaN	Blue	99637.545455	44976.00
# 23	CAR024	Toyota	SUV	2020	43044.0	27662.0	White	27662.000000	43044.00
# 24	CAR025	Toyota	Hatchback	2006	56214.0	13392.0	Green	13392.000000	56214.00

df_dropped_cols = df.dropna(subset=["Car_Brand", "Colour"])
print(df_dropped_cols)
# Car_ID	Car_Brand	Car_Type	Year_Made	Cost_In_Pounds	Distance_Travelled_In_Miles	Colour	Distance_Travelled_In_Miles_Filled	Cost_In_Pounds_Filled
# 0	CAR001	Honda	Coupe	2022	NaN	197300.0	White	197300.000000	31240.95
# 1	CAR002	Chevrolet	Coupe	2009	42065.0	119752.0	Blue	119752.000000	42065.00
# 2	CAR003	BMW	SUV	2022	31557.0	53984.0	Red	53984.000000	31557.00
# 3	CAR004	Chevrolet	Hatchback	2001	38763.0	45774.0	Yellow	45774.000000	38763.00
# 4	CAR005	Chevrolet	Hatchback	2006	37606.0	7568.0	Green	7568.000000	37606.00
# 5	CAR006	Ford	Coupe	2023	16534.0	125151.0	Black	125151.000000	16534.00
# 6	CAR007	BMW	Hatchback	2002	34127.0	198664.0	White	198664.000000	34127.00
# 7	CAR008	BMW	Hatchback	2009	NaN	138767.0	Yellow	138767.000000	31240.95
# 8	CAR009	BMW	Sedan	1997	NaN	129375.0	Black	129375.000000	31240.95
# 10	CAR011	Honda	Convertible	2011	29253.0	141330.0	Red	141330.000000	29253.00
# 11	CAR012	BMW	Coupe	1998	29276.0	44504.0	Black	44504.000000	29276.00
# 13	CAR014	Ford	Sedan	2002	29300.0	NaN	Yellow	99637.545455	29300.00
# 14	CAR015	Honda	SUV	1998	13529.0	66858.0	Black	66858.000000	13529.00
# 16	CAR017	Honda	Sedan	2000	14268.0	NaN	Green	99637.545455	14268.00
# 19	CAR020	Honda	SUV	1998	26243.0	31854.0	Black	31854.000000	26243.00
# 20	CAR021	Ford	Sedan	2016	44099.0	69505.0	Red	69505.000000	44099.00
# 21	CAR022	Chevrolet	SUV	2023	NaN	109488.0	Blue	109488.000000	31240.95
# 22	CAR023	Honda	Convertible	2012	44976.0	NaN	Blue	99637.545455	44976.00
# 23	CAR024	Toyota	SUV	2020	43044.0	27662.0	White	27662.000000	43044.00
# 24	CAR025	Toyota	Hatchback	2006	56214.0	13392.0	Green	13392.000000	56214.00

df_dc = df_dropped_cols
filtered = df_dc[(df_dc["Colour"] == "Blue") & (df_dc["Distance_Travelled_In_Miles_Filled"] > 10000)]
print(filtered)
# Car_ID	Car_Brand	Car_Type	Year_Made	Cost_In_Pounds	Distance_Travelled_In_Miles	Colour	Distance_Travelled_In_Miles_Filled	Cost_In_Pounds_Filled
# 1	CAR002	Chevrolet	Coupe	2009	42065.0	119752.0	Blue	119752.000000	42065.00
# 21	CAR022	Chevrolet	SUV	2023	NaN	109488.0	Blue	109488.000000	31240.95
# 22	CAR023	Honda	Convertible	2012	44976.0	NaN	Blue	99637.545455	44976.00

most_miles = df_dc.sort_values(by="Distance_Travelled_In_Miles_Filled", ascending=False)
print(most_miles)
# Car_ID	Car_Brand	Car_Type	Year_Made	Cost_In_Pounds	Distance_Travelled_In_Miles	Colour	Distance_Travelled_In_Miles_Filled	Cost_In_Pounds_Filled
# 6	CAR007	BMW	Hatchback	2002	34127.0	198664.0	White	198664.000000	34127.00
# 0	CAR001	Honda	Coupe	2022	NaN	197300.0	White	197300.000000	31240.95
# 10	CAR011	Honda	Convertible	2011	29253.0	141330.0	Red	141330.000000	29253.00
# 7	CAR008	BMW	Hatchback	2009	NaN	138767.0	Yellow	138767.000000	31240.95
# 8	CAR009	BMW	Sedan	1997	NaN	129375.0	Black	129375.000000	31240.95
# 5	CAR006	Ford	Coupe	2023	16534.0	125151.0	Black	125151.000000	16534.00
# 1	CAR002	Chevrolet	Coupe	2009	42065.0	119752.0	Blue	119752.000000	42065.00
# 21	CAR022	Chevrolet	SUV	2023	NaN	109488.0	Blue	109488.000000	31240.95
# 22	CAR023	Honda	Convertible	2012	44976.0	NaN	Blue	99637.545455	44976.00
# 13	CAR014	Ford	Sedan	2002	29300.0	NaN	Yellow	99637.545455	29300.00
# 16	CAR017	Honda	Sedan	2000	14268.0	NaN	Green	99637.545455	14268.00
# 20	CAR021	Ford	Sedan	2016	44099.0	69505.0	Red	69505.000000	44099.00
# 14	CAR015	Honda	SUV	1998	13529.0	66858.0	Black	66858.000000	13529.00
# 2	CAR003	BMW	SUV	2022	31557.0	53984.0	Red	53984.000000	31557.00
# 3	CAR004	Chevrolet	Hatchback	2001	38763.0	45774.0	Yellow	45774.000000	38763.00
# 11	CAR012	BMW	Coupe	1998	29276.0	44504.0	Black	44504.000000	29276.00
# 19	CAR020	Honda	SUV	1998	26243.0	31854.0	Black	31854.000000	26243.00
# 23	CAR024	Toyota	SUV	2020	43044.0	27662.0	White	27662.000000	43044.00
# 24	CAR025	Toyota	Hatchback	2006	56214.0	13392.0	Green	13392.000000	56214.00
# 4	CAR005	Chevrolet	Hatchback	2006	37606.0	7568.0	Green	7568.000000	37606.00
